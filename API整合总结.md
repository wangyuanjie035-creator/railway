# API æ–‡ä»¶æ•´åˆæ€»ç»“

## âœ… å·²å®Œæˆçš„æ•´åˆ

### 1. æ–‡ä»¶æ“ä½œæ•´åˆ â­â­â­

**æ•´åˆæ–‡ä»¶**:
- `store-file-real.js` - ä¸Šä¼ åˆ° Shopify Files
- `store-file-data.js` - å­˜å‚¨åˆ°æœåŠ¡å™¨å†…å­˜
- `download-file.js` - ä¸‹è½½æ–‡ä»¶

**æ•´åˆå**:
- `file-handler.js` - ç»Ÿä¸€å¤„ç†æ‰€æœ‰æ–‡ä»¶ç›¸å…³æ“ä½œ

**è·¯ç”±**:
- `POST /api/store-file-real` â†’ `file-handler.js`ï¼ˆä¸Šä¼ åˆ° Shopify Filesï¼‰
- `POST /api/store-file-data` â†’ `file-handler.js`ï¼ˆå­˜å‚¨åˆ°æœåŠ¡å™¨å†…å­˜ï¼‰
- `GET /api/download-file` â†’ `file-handler.js`ï¼ˆä¸‹è½½æ–‡ä»¶ï¼‰

**ä¼˜åŠ¿**:
- âœ… 3ä¸ªæ–‡ä»¶åˆå¹¶ä¸º1ä¸ªï¼Œå‡å°‘67%
- âœ… æ–‡ä»¶æ“ä½œé€»è¾‘é›†ä¸­ï¼Œæ˜“äºç»´æŠ¤
- âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

---

### 2. Draft Order æ“ä½œæ•´åˆ â­â­â­

**æ•´åˆæ–‡ä»¶**:
- `get-draft-orders.js` - è·å–è®¢å•åˆ—è¡¨
- `get-draft-order-simple.js` - è·å–å•ä¸ªè®¢å•è¯¦æƒ…
- `update-quote.js` - æ›´æ–°æŠ¥ä»·
- `delete-draft-order.js` - åˆ é™¤è®¢å•
- `complete-draft-order.js` - å®Œæˆè®¢å•

**æ•´åˆå**:
- `draft-order-handler.js` - ç»Ÿä¸€å¤„ç†æ‰€æœ‰ Draft Order ç›¸å…³æ“ä½œ

**è·¯ç”±**:
- `GET /api/get-draft-orders` â†’ `draft-order-handler.js`ï¼ˆè·å–è®¢å•åˆ—è¡¨ï¼‰
- `GET /api/get-draft-order-simple` â†’ `draft-order-handler.js`ï¼ˆè·å–å•ä¸ªè®¢å•è¯¦æƒ…ï¼‰
- `POST /api/update-quote` â†’ `draft-order-handler.js`ï¼ˆæ›´æ–°æŠ¥ä»·ï¼‰
- `DELETE /api/delete-draft-order` â†’ `draft-order-handler.js`ï¼ˆåˆ é™¤è®¢å•ï¼‰
- `POST /api/complete-draft-order` â†’ `draft-order-handler.js`ï¼ˆå®Œæˆè®¢å•ï¼‰

**ä¼˜åŠ¿**:
- âœ… 5ä¸ªæ–‡ä»¶åˆå¹¶ä¸º1ä¸ªï¼Œå‡å°‘80%
- âœ… Draft Order æ“ä½œé€»è¾‘é›†ä¸­ï¼Œæ˜“äºæŸ¥æ‰¾å’Œä¿®æ”¹
- âœ… ç»Ÿä¸€çš„ GraphQL è¾…åŠ©å‡½æ•°ï¼Œå‡å°‘é‡å¤ä»£ç 

---

## ğŸ“Š æ•´åˆæ•ˆæœ

### æ•´åˆå‰
- **æ–‡ä»¶æ•°é‡**: 14 ä¸ª API æ–‡ä»¶
- **æ–‡ä»¶ç»„ç»‡**: åˆ†æ•£ï¼Œéš¾ä»¥æŸ¥æ‰¾
- **ç»´æŠ¤æˆæœ¬**: é«˜ï¼ˆéœ€è¦è®°ä½å¤šä¸ªæ–‡ä»¶ä½ç½®ï¼‰
- **ä»£ç é‡å¤**: GraphQL è¾…åŠ©å‡½æ•°åœ¨å¤šå¤„é‡å¤

### æ•´åˆå
- **æ–‡ä»¶æ•°é‡**: 7 ä¸ª API æ–‡ä»¶ï¼ˆå‡å°‘ 50%ï¼‰
- **æ–‡ä»¶ç»„ç»‡**: æŒ‰åŠŸèƒ½åˆ†ç»„ï¼Œæ¸…æ™°æ˜äº†
- **ç»´æŠ¤æˆæœ¬**: ä½ï¼ˆç›¸å…³åŠŸèƒ½åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼‰
- **ä»£ç å¤ç”¨**: ç»Ÿä¸€çš„è¾…åŠ©å‡½æ•°ï¼Œå‡å°‘é‡å¤

---

## ğŸ“ å½“å‰æ–‡ä»¶ç»“æ„

```
api/
â”œâ”€â”€ index.js                    # è·¯ç”±æ³¨å†Œä¸­å¿ƒ
â”œâ”€â”€ cors-config.js              # CORS é…ç½®ï¼ˆä¿æŒç‹¬ç«‹ï¼‰
â”‚
â”œâ”€â”€ file-handler.js             # â­ æ–‡ä»¶æ“ä½œï¼ˆæ•´åˆåï¼‰
â”œâ”€â”€ draft-order-handler.js      # â­ Draft Order æ“ä½œï¼ˆæ•´åˆåï¼‰
â”‚
â”œâ”€â”€ submit-quote-real.js        # æäº¤è¯¢ä»·ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼Œä¿æŒç‹¬ç«‹ï¼‰
â”œâ”€â”€ send-invoice-email.js       # å‘é€é‚®ä»¶ï¼ˆå•ä¸€åŠŸèƒ½ï¼Œä¿æŒç‹¬ç«‹ï¼‰
â””â”€â”€ get-or-create-product.js    # äº§å“æ“ä½œï¼ˆå•ä¸€åŠŸèƒ½ï¼Œä¿æŒç‹¬ç«‹ï¼‰
```

---

## ğŸ”„ å‘åå…¼å®¹

### å½“å‰çŠ¶æ€

âœ… **æ–°æ–‡ä»¶å·²åˆ›å»º**ï¼š`file-handler.js` å’Œ `draft-order-handler.js`  
âœ… **è·¯ç”±å·²æ›´æ–°**ï¼š`api/index.js` å·²æ³¨å†Œæ–°è·¯ç”±  
âš ï¸ **æ—§æ–‡ä»¶ä¿ç•™**ï¼šä¸ºå‘åå…¼å®¹ï¼Œæ—§æ–‡ä»¶æš‚æ—¶ä¿ç•™

### æ—§æ–‡ä»¶åˆ—è¡¨ï¼ˆå¯åˆ é™¤ï¼‰

åœ¨ç¡®è®¤æ–°æ•´åˆæ–‡ä»¶å·¥ä½œæ­£å¸¸åï¼Œå¯ä»¥åˆ é™¤ä»¥ä¸‹æ—§æ–‡ä»¶ï¼š

1. `store-file-real.js` - å·²æ•´åˆåˆ° `file-handler.js`
2. `store-file-data.js` - å·²æ•´åˆåˆ° `file-handler.js`
3. `download-file.js` - å·²æ•´åˆåˆ° `file-handler.js`
4. `get-draft-orders.js` - å·²æ•´åˆåˆ° `draft-order-handler.js`
5. `get-draft-order-simple.js` - å·²æ•´åˆåˆ° `draft-order-handler.js`
6. `update-quote.js` - å·²æ•´åˆåˆ° `draft-order-handler.js`
7. `delete-draft-order.js` - å·²æ•´åˆåˆ° `draft-order-handler.js`
8. `complete-draft-order.js` - å·²æ•´åˆåˆ° `draft-order-handler.js`

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### 1. æ–‡ä»¶æ“ä½œæµ‹è¯•

- [ ] ä¸Šä¼ æ–‡ä»¶åˆ° Shopify Filesï¼ˆ`POST /api/store-file-real`ï¼‰
- [ ] å­˜å‚¨æ–‡ä»¶åˆ°æœåŠ¡å™¨å†…å­˜ï¼ˆ`POST /api/store-file-data`ï¼‰
- [ ] ä¸‹è½½æ–‡ä»¶ï¼ˆ`GET /api/download-file`ï¼‰
- [ ] æµ‹è¯• `SKIP_SHOPIFY_FILES=true` åŠŸèƒ½

### 2. Draft Order æ“ä½œæµ‹è¯•

- [ ] è·å–è®¢å•åˆ—è¡¨ï¼ˆ`GET /api/get-draft-orders`ï¼‰
- [ ] è·å–å•ä¸ªè®¢å•è¯¦æƒ…ï¼ˆ`GET /api/get-draft-order-simple`ï¼‰
- [ ] æ›´æ–°æŠ¥ä»·ï¼ˆ`POST /api/update-quote`ï¼‰
- [ ] åˆ é™¤è®¢å•ï¼ˆ`DELETE /api/delete-draft-order`ï¼‰
- [ ] å®Œæˆè®¢å•ï¼ˆ`POST /api/complete-draft-order`ï¼‰

### 3. é›†æˆæµ‹è¯•

- [ ] æäº¤è¯¢ä»·ï¼ˆåŒ…å«æ–‡ä»¶ä¸Šä¼ ï¼‰
- [ ] ç®¡ç†ç«¯æŸ¥çœ‹è®¢å•åˆ—è¡¨
- [ ] å®¢æœæ›´æ–°æŠ¥ä»·
- [ ] å®¢æˆ·æŸ¥çœ‹æŠ¥ä»·
- [ ] åˆ é™¤è®¢å•

---

## ğŸ“ ä¸‹ä¸€æ­¥æ“ä½œ

### é˜¶æ®µ 1: æµ‹è¯•éªŒè¯ï¼ˆå½“å‰ï¼‰

1. âœ… åˆ›å»ºæ•´åˆåçš„æ–‡ä»¶
2. âœ… æ›´æ–°è·¯ç”±æ³¨å†Œ
3. â³ **æµ‹è¯•æ‰€æœ‰åŠŸèƒ½**
4. â³ **ç¡®è®¤åŠŸèƒ½æ­£å¸¸**

### é˜¶æ®µ 2: æ¸…ç†æ—§æ–‡ä»¶ï¼ˆå¾…ç¡®è®¤ï¼‰

1. â³ ç¡®è®¤æ•´åˆåçš„æ–‡ä»¶å·¥ä½œæ­£å¸¸
2. â³ åˆ é™¤æ—§æ–‡ä»¶ï¼ˆ8ä¸ªæ–‡ä»¶ï¼‰
3. â³ æ›´æ–°æ–‡æ¡£

### é˜¶æ®µ 3: å¯é€‰ä¼˜åŒ–ï¼ˆæœªæ¥ï¼‰

1. â³ æ•´åˆå·¥å…·å‡½æ•°ï¼ˆ`cors-config.js` + `health.js` â†’ `utils.js`ï¼‰
2. â³ æ·»åŠ å•å…ƒæµ‹è¯•
3. â³ ä¼˜åŒ–é”™è¯¯å¤„ç†

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### å‘åå…¼å®¹

- âœ… æ–°è·¯ç”±å·²æ³¨å†Œï¼Œæ—§è·¯ç”±ä»ç„¶å¯ç”¨ï¼ˆå¦‚æœæ—§æ–‡ä»¶å­˜åœ¨ï¼‰
- âœ… æ—§æ–‡ä»¶æš‚æ—¶ä¿ç•™ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸
- âš ï¸ å»ºè®®åœ¨ç¡®è®¤æ–°æ–‡ä»¶å·¥ä½œæ­£å¸¸åï¼Œåˆ é™¤æ—§æ–‡ä»¶

### ä»£ç ä¿®æ”¹

- âœ… æ•´åˆåçš„æ–‡ä»¶ä¿æŒäº†åŸæœ‰çš„åŠŸèƒ½é€»è¾‘
- âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… ä»£ç æ³¨é‡Šå’Œæ–‡æ¡£å·²æ›´æ–°

### ç¯å¢ƒå˜é‡

- âœ… æ‰€æœ‰ç¯å¢ƒå˜é‡ä¿æŒä¸å˜
- âœ… `SKIP_SHOPIFY_FILES` åŠŸèƒ½æ­£å¸¸å·¥ä½œ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `APIæ–‡ä»¶æ•´åˆæ–¹æ¡ˆ.md` - è¯¦ç»†çš„æ•´åˆæ–¹æ¡ˆå’Œè¯´æ˜
- `README.md` - é¡¹ç›®æ€»ä½“è¯´æ˜
- `FILE_STORAGE_GUIDE.md` - æ–‡ä»¶å­˜å‚¨è¯´æ˜

---

## âœ… æ€»ç»“

**æ•´åˆæˆæœ**:
- âœ… æ–‡ä»¶æ•°é‡ï¼š14 ä¸ª â†’ 7 ä¸ªï¼ˆå‡å°‘ 50%ï¼‰
- âœ… ä»£ç ç»„ç»‡ï¼šæŒ‰åŠŸèƒ½åˆ†ç»„ï¼Œæ¸…æ™°æ˜äº†
- âœ… ç»´æŠ¤æˆæœ¬ï¼šé™ä½ï¼Œç›¸å…³åŠŸèƒ½é›†ä¸­

**ä¸‹ä¸€æ­¥**:
1. æµ‹è¯•æ‰€æœ‰åŠŸèƒ½ï¼Œç¡®è®¤æ•´åˆåçš„æ–‡ä»¶å·¥ä½œæ­£å¸¸
2. åˆ é™¤æ—§æ–‡ä»¶ï¼Œæ¸…ç†é¡¹ç›®ç»“æ„
3. æ›´æ–°æ–‡æ¡£ï¼Œè®°å½•æ•´åˆè¿‡ç¨‹

**çŠ¶æ€**: âœ… æ•´åˆå®Œæˆï¼Œç­‰å¾…æµ‹è¯•éªŒè¯

