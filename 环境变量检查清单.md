# 环境变量检查清单

## 重要环境变量

### 必须配置

1. **Shopify 商店域名**
   - `SHOPIFY_STORE_DOMAIN` 或 `SHOP`
   - 示例：`sain-pdc-test.myshopify.com`

2. **Shopify 访问令牌**
   - `SHOPIFY_ACCESS_TOKEN` 或 `ADMIN_TOKEN`
   - 示例：`shpat_xxxxxxxxxxxxxxxxxxxxxxxxxx`

3. **公共基础 URL**（可选，但建议配置）
   - `PUBLIC_BASE_URL`
   - 示例：`https://your-railway-app.up.railway.app`

### 可选环境变量

4. **跳过 Shopify Files**（⚠️ 仅用于紧急回退）
   - `SKIP_SHOPIFY_FILES`
   - 如果设置为 `true`，将跳过 Shopify Files 上传，使用本地存储
   - **默认值**：`false` 或不设置（会上传到 Shopify Files）
   - **建议**：不要设置此变量，除非遇到 Shopify Files 上传问题

5. **端口**（Railway 自动设置）
   - `PORT`
   - Railway 会自动设置，不需要手动配置

6. **Node 环境**
   - `NODE_ENV`
   - 可选：`production` 或 `development`

---

## Railway 环境变量配置

### 步骤 1: 打开 Railway 项目设置

1. 登录 Railway
2. 打开你的项目
3. 点击 "Variables" 标签

### 步骤 2: 配置必需变量

添加以下变量：

```
SHOPIFY_STORE_DOMAIN=sain-pdc-test.myshopify.com
SHOPIFY_ACCESS_TOKEN=shpat_xxxxxxxxxxxxxxxxxxxxxxxxxx
PUBLIC_BASE_URL=https://your-railway-app.up.railway.app
```

### 步骤 3: 检查跳过变量

**重要**：检查是否有 `SKIP_SHOPIFY_FILES` 变量：

- ✅ **如果要使用 Shopify Files**：删除此变量或设置为 `false`
- ⚠️ **如果遇到上传问题**：可以临时设置为 `true` 使用本地存储

---

## 验证环境变量

部署后，查看日志确认环境变量：

```bash
# 应该看到类似输出：
🔧 SKIP_SHOPIFY_FILES 环境变量值: undefined 或 false
```

如果看到：
```
⚠️ SKIP_SHOPIFY_FILES=true，跳过 Shopify Files
```

说明环境变量已设置为跳过。

---

## 常见问题

### Q: 为什么文件还是跳过了 Shopify Files？

A: 可能的原因：
1. Railway 环境变量中设置了 `SKIP_SHOPIFY_FILES=true`
2. 需要删除此变量或设置为 `false`

### Q: 如何确认环境变量是否正确？

A: 
1. 查看 Railway 日志
2. 查找 "SKIP_SHOPIFY_FILES 环境变量值" 日志
3. 确认值为 `undefined` 或 `false`

### Q: 我应该设置 SKIP_SHOPIFY_FILES 吗？

A: 
- **默认**：不要设置（会上传到 Shopify Files）
- **仅在遇到问题时**：可以临时设置为 `true` 使用本地存储
- **生产环境**：建议删除此变量，确保上传到 Shopify Files

---

**最后更新**: 2025-01-21

