# ✅ Railway 部署检查清单

## 📋 部署前检查

### 必需文件（已完成）
- [x] `Dockerfile` - Docker 配置文件
- [x] `package.json` - Node.js 依赖配置
- [x] `server.js` - Express 服务器
- [x] `railway.json` - Railway 配置
- [x] `api/index.js` - API 路由入口
- [x] `env.example` - 环境变量示例

### 需要准备的信息
- [ ] Shopify Store Domain（如：your-store.myshopify.com）
- [ ] Shopify Access Token（以 shpat_ 开头）
- [ ] GitHub 账号（用于登录 Railway）

---

## 🚀 部署步骤快速检查

### 第一阶段：准备工作（10 分钟）

- [ ] **1. 注册 Railway 账号**
  - 访问：https://railway.app
  - 使用 GitHub 登录
  
- [ ] **2. 安装 Railway CLI**
  ```bash
  npm install -g @railway/cli
  ```
  
- [ ] **3. 登录 Railway**
  ```bash
  railway login
  ```

### 第二阶段：配置项目（5 分钟）

- [ ] **4. 复制环境变量文件**
  ```bash
  copy env.example .env
  ```
  
- [ ] **5. 编辑 .env 文件**
  - 填入 SHOPIFY_STORE_DOMAIN
  - 填入 SHOPIFY_ACCESS_TOKEN

### 第三阶段：部署（5 分钟）

- [ ] **6. 初始化 Railway 项目**
  ```bash
  railway init
  ```
  
- [ ] **7. 设置环境变量**
  ```bash
  railway variables set SHOPIFY_STORE_DOMAIN=your-store.myshopify.com
  railway variables set SHOPIFY_ACCESS_TOKEN=your_token
  railway variables set NODE_ENV=production
  railway variables set PORT=3000
  ```
  
- [ ] **8. 部署应用**
  ```bash
  railway up
  ```

### 第四阶段：测试（5 分钟）

- [ ] **9. 获取部署 URL**
  ```bash
  railway status
  ```
  
- [ ] **10. 测试主页**
  - 访问：`https://your-app.up.railway.app/`
  - 应该显示欢迎页面
  
- [ ] **11. 测试 API**
  - 访问：`https://your-app.up.railway.app/api/health`
  - 应该返回 JSON：`{"status":"healthy"}`
  
- [ ] **12. 测试管理员页面**
  - 访问：`https://your-app.up.railway.app/pages/admin-draft-orders`
  - 应该显示登录界面

### 第五阶段：更新前端（5 分钟）

- [ ] **13. 记录 Railway URL**
  ```
  https://your-app.up.railway.app
  ```
  
- [ ] **14. 更新以下文件中的 API_BASE**
  - [ ] `templates/page.admin-draft-orders.liquid`
  - [ ] `templates/page.my-quotes.liquid`
  - [ ] `templates/page.quote-request.liquid`
  
  将所有：
  ```javascript
  const API_BASE = 'https://shopify-13s4.vercel.app/api';
  ```
  
  改为：
  ```javascript
  const API_BASE = 'https://your-app.up.railway.app/api';
  ```
  
- [ ] **15. 重新部署**
  ```bash
  railway up
  ```

---

## 🧪 功能测试清单

### 核心功能测试

- [ ] **管理员登录**
  - 访问管理员页面
  - 输入密码：admin123
  - 成功进入后台
  
- [ ] **订单列表**
  - 能看到现有订单
  - 显示正确的订单信息
  
- [ ] **文件下载**
  - 点击下载按钮
  - 文件成功下载
  - 文件内容正确
  
- [ ] **报价功能**
  - 为订单添加报价
  - 报价成功保存
  - 价格显示正确（美元）
  
- [ ] **发送邮件**
  - 发送发票邮件
  - 邮件成功发送
  
- [ ] **客户询价页面**
  - 客户可以提交询价
  - 文件上传成功
  - 创建订单成功

---

## 🔍 问题检查清单

如果遇到问题，按照此清单排查：

### 部署失败

- [ ] 检查 Dockerfile 是否存在
- [ ] 检查 package.json 是否正确
- [ ] 查看 Railway 日志：`railway logs`
- [ ] 检查环境变量是否设置

### 应用无法访问

- [ ] 检查部署状态：`railway status`
- [ ] 检查 URL 是否正确
- [ ] 查看服务器日志：`railway logs`
- [ ] 尝试重启：`railway restart`

### 环境变量问题

- [ ] 检查变量列表：`railway variables`
- [ ] 确认拼写正确
- [ ] 确认值已设置
- [ ] 重启服务：`railway restart`

### 文件下载 404

- [ ] 确认 API_BASE 已更新
- [ ] 检查 Railway URL 是否正确
- [ ] 查看浏览器控制台错误
- [ ] 查看服务器日志

---

## 📊 监控检查清单

### 每日检查

- [ ] 查看服务状态
- [ ] 检查是否有错误日志
- [ ] 验证核心功能正常

### 每周检查

- [ ] 查看资源使用情况
- [ ] 检查费用使用（确保在免费额度内）
- [ ] 更新必要的依赖

### 每月检查

- [ ] 审查所有日志
- [ ] 性能优化
- [ ] 安全更新

---

## 💰 费用检查

- [ ] 登录 Railway 控制台
- [ ] 查看 Usage 页面
- [ ] 确认在 $5 免费额度内
- [ ] 如果超出，考虑优化或升级

---

## 🎯 成功标准

完成以下所有项即为部署成功：

### 技术指标
- [x] 应用成功部署到 Railway
- [ ] 所有环境变量正确配置
- [ ] 公网 URL 可以访问
- [ ] API 健康检查返回正常
- [ ] 日志没有严重错误

### 功能指标
- [ ] 管理员可以登录
- [ ] 可以查看订单列表
- [ ] 文件下载功能正常
- [ ] 报价功能正常
- [ ] 邮件发送功能正常
- [ ] 客户可以提交询价

### 性能指标
- [ ] 页面加载时间 < 3 秒
- [ ] API 响应时间 < 1 秒
- [ ] 文件下载速度正常

---

## 📝 部署记录

记录您的部署信息：

```
部署日期：____________________
Railway URL：____________________
项目名称：____________________
环境：生产环境
费用计划：免费额度
```

---

## 🎉 完成！

当所有检查项都完成后，恭喜您成功部署！

**后续步骤：**
1. 定期监控应用状态
2. 根据用户反馈优化功能
3. 保持代码更新
4. 备份重要数据

**需要帮助？**
- 查看详细指南：`RAILWAY_部署操作指南.md`
- 查看故障排除：`DOCKER_RAILWAY_DEPLOYMENT_GUIDE.md`
- Railway 文档：https://docs.railway.app
